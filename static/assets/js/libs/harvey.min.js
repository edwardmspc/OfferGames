// Generated by CoffeeScript 1.3.3
/*

  Harvey, A Second Face for Your Application's JavaScript

  Copyright 2012, Joschka Kintscher
  Released under the MIT License

  https://github.com/harvesthq/harvey/
*/
(function(){var e,t;this.Harvey=function(){function n(){}n.states={};n.attach=function(t,n){var r;if(!this.states.hasOwnProperty(t)){this.states[t]=[];this._add_css_for(t)}r=new e(t,n!=null?n.setup:void 0,n!=null?n.on:void 0,n!=null?n.off:void 0);this.states[t].length||this._watch_query(t);this.states[t].push(r);this._window_matchmedia(t).matches&&this._update_states([r],!0);return r};n.detach=function(e){var t,n,r,i,s,o;s=this.states[e.condition];o=[];for(t=r=0,i=s.length;r<i;t=++r){n=s[t];e===n?o.push(this.states[n.condition][t]=void 0):o.push(void 0)}return o};n._watch_query=function(e){var t=this;return this._window_matchmedia(e).addListener(function(n){return t._update_states(t.states[e],n.matches)})};n._update_states=function(e,t){var n,r,i,s;s=[];for(r=0,i=e.length;r<i;r++){n=e[r];t?s.push(n.activate()):s.push(n.deactivate())}return s};n._mediaList={};n._window_matchmedia=function(e){if(window.matchMedia){e in this._mediaList||(this._mediaList[e]=window.matchMedia(e));return this._mediaList[e]}this._listening||this._listen();e in this._mediaList||(this._mediaList[e]=new t(e));return this._mediaList[e]};n._listen=function(){var e,t=this;e=window.addEventListener||window.attachEvent;e("resize",function(){var e,n,r,i;r=t._mediaList;i=[];for(n in r){e=r[n];i.push(e._process())}return i});e("orientationChange",function(){var e,n,r,i;r=t._mediaList;i=[];for(n in r){e=r[n];i.push(e._process())}return i});return this._listening=!0};n._add_css_for=function(e){if(!this.style){this.style=document.createElement("style");this.style.setAttribute("type","text/css");document.getElementsByTagName("head")[0].appendChild(this.style)}e="@media "+e+" {.harvey-test{}}";if(!this.style.styleSheet)return this.style.appendChild(document.createTextNode(e))};return n}();e=function(){function e(e,t,n,r){this.condition=e;this.setup=t;this.on=n;this.off=r}e.prototype.active=!1;e.prototype.is_setup=!1;e.prototype.activate=function(){if(this.active)return;if(!this.is_setup){typeof this.setup=="function"&&this.setup();this.is_setup=!0}typeof this.on=="function"&&this.on();return this.active=!0};e.prototype.deactivate=function(){if(!this.active)return;typeof this.off=="function"&&this.off();return this.active=!1};return e}();t=function(){function e(e){this.media=e;this._listeners=[];this.matches=this._matches()}e.prototype.addListener=function(e){this._listeners.push(e);return void 0};e.prototype._process=function(){var e,t,n,r,i,s;t=this._matches();if(this.matches===t)return;this.matches=t;i=this._listeners;s=[];for(n=0,r=i.length;n<r;n++){e=i[n];s.push(e(this))}return s};e.prototype._matches=function(){this._tester||this._get_tester();this._tester.innerHTML='&shy;<style media="'+this.media+'">#harvey-mq-test{width:42px;}</style>';this._tester.removeChild(this._tester.firstChild);return this._tester.offsetWidth===42};e.prototype._get_tester=function(){this._tester=document.getElementById("harvey-mq-test");if(!this._tester)return this._build_tester()};e.prototype._build_tester=function(){this._tester=document.createElement("div");this._tester.id="harvey-mq-test";this._tester.style.cssText="position:absolute;top:-100em";return document.body.insertBefore(this._tester,document.body.firstChild)};return e}()}).call(this);
